// ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏Ñ‡πà‡∏≤‡∏Ç‡∏≠‡∏á Token ‡πÅ‡∏•‡∏∞ Template ID ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏Å‡∏±‡∏ö LINE Notify ‡πÅ‡∏•‡∏∞ Blynk
#define LINE_TOKEN "BAwPVl5Qq41LhakbJLOsgwCp8bidWP6tJzrf5rBgFzS" // ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏Ñ‡πà‡∏≤ Token ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö LINE Notify ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏ä‡πâ‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°
#define BLYNK_AUTH_TOKEN "vN8aqkSZeKmBAhLfyZfTXUIBeHg16I1n"      // ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏Ñ‡πà‡∏≤ Authentication Token ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Blynk
#define BLYNK_TEMPLATE_ID "TMPL6burwBeTL"                        // ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏Ñ‡πà‡∏≤ Template ID ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Blynk
#define BLYNK_TEMPLATE_NAME "PenPurchasingMachine"               // ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏ä‡∏∑‡πà‡∏≠ Template ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Blynk

// ‡∏£‡∏ß‡∏°‡πÑ‡∏•‡∏ö‡∏£‡∏≤‡∏£‡∏µ‡∏ï‡πà‡∏≤‡∏á ‡πÜ ‡∏ó‡∏µ‡πà‡∏à‡∏≥‡πÄ‡∏õ‡πá‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏Ç‡∏≠‡∏á‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏Ç‡∏≤‡∏¢‡∏õ‡∏≤‡∏Å‡∏Å‡∏≤
#include <Arduino.h>          // ‡πÑ‡∏•‡∏ö‡∏£‡∏≤‡∏£‡∏µ‡∏´‡∏•‡∏±‡∏Å‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Arduino
#include <WiFi.h>             // ‡πÑ‡∏•‡∏ö‡∏£‡∏≤‡∏£‡∏µ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠ WiFi
#include <ESP32Servo.h>       // ‡πÑ‡∏•‡∏ö‡∏£‡∏≤‡∏£‡∏µ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏°‡πÄ‡∏ã‡∏≠‡∏£‡πå‡πÇ‡∏ß‡∏°‡∏≠‡πÄ‡∏ï‡∏≠‡∏£‡πå
#include <Wire.h>             // ‡πÑ‡∏•‡∏ö‡∏£‡∏≤‡∏£‡∏µ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏™‡∏∑‡πà‡∏≠‡∏™‡∏≤‡∏£ I2C
#include <LiquidCrystal.h>    // ‡πÑ‡∏•‡∏ö‡∏£‡∏≤‡∏£‡∏µ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏°‡∏à‡∏≠ LCD
#include <WiFiManager.h>      // ‡πÑ‡∏•‡∏ö‡∏£‡∏≤‡∏£‡∏µ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠ WiFi
#include <HTTPClient.h>       // ‡πÑ‡∏•‡∏ö‡∏£‡∏≤‡∏£‡∏µ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏™‡πà‡∏á HTTP requests
#include <BlynkSimpleEsp32.h> // ‡πÑ‡∏•‡∏ö‡∏£‡∏≤‡∏£‡∏µ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏Å‡∏±‡∏ö Blynk

// ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏û‡∏¥‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏Å‡∏±‡∏ö‡∏à‡∏≠ LCD
const int rs = 22, en = 21, d4 = 18, d5 = 17, d6 = 16, d7 = 15; // ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏û‡∏¥‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏Å‡∏±‡∏ö‡∏à‡∏≠ LCD
LiquidCrystal lcd(rs, en, d4, d5, d6, d7);                      // ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏≠‡πá‡∏≠‡∏ö‡πÄ‡∏à‡πá‡∏Å‡∏ï‡πå LCD ‡∏î‡πâ‡∏ß‡∏¢‡∏û‡∏¥‡∏ô‡∏ó‡∏µ‡πà‡∏Å‡∏≥‡∏´‡∏ô‡∏î

// ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏ä‡∏∑‡πà‡∏≠‡πÅ‡∏•‡∏∞‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡∏Ç‡∏≠‡∏á WiFi ‡∏ó‡∏µ‡πà‡∏à‡∏∞‡πÉ‡∏ä‡πâ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠
const char *WIFI_NAME = "!PEN PURCHASING MACHINE"; // ‡∏ä‡∏∑‡πà‡∏≠ WiFi ‡∏ó‡∏µ‡πà‡∏à‡∏∞‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠
const char *WIFI_PASSWORD = "11111111";            // ‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô WiFi

// ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏û‡∏¥‡∏ô‡πÅ‡∏•‡∏∞‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏ô‡∏±‡∏ö‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏á‡∏¥‡∏ô‡∏ó‡∏µ‡πà‡∏£‡∏±‡∏ö‡∏à‡∏≤‡∏Å‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏ï‡∏£‡∏ß‡∏à‡πÄ‡∏´‡∏£‡∏µ‡∏¢‡∏ç
const int coinValidatorPin = 13;             // ‡∏û‡∏¥‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏Å‡∏±‡∏ö‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏ï‡∏£‡∏ß‡∏à‡πÄ‡∏´‡∏£‡∏µ‡∏¢‡∏ç
volatile int totalAmount = 0;                // ‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£‡πÄ‡∏Å‡πá‡∏ö‡∏¢‡∏≠‡∏î‡∏£‡∏ß‡∏°‡πÄ‡∏á‡∏¥‡∏ô
volatile unsigned long lastDebounceTime = 0; // ‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏Å‡∏£‡∏∞‡∏ï‡∏∏‡∏Å‡∏Ç‡∏≠‡∏á‡∏™‡∏±‡∏ç‡∏ç‡∏≤‡∏ì
const unsigned long debounceDelay = 200;     // ‡∏£‡∏∞‡∏¢‡∏∞‡πÄ‡∏ß‡∏•‡∏≤‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏Å‡∏£‡∏∞‡∏ï‡∏∏‡∏Å (200 ‡∏°‡∏¥‡∏•‡∏•‡∏¥‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ)
volatile int pulseCount = 0;                 // ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏û‡∏±‡∏•‡∏™‡πå‡∏ó‡∏µ‡πà‡∏ô‡∏±‡∏ö‡πÑ‡∏î‡πâ‡∏à‡∏≤‡∏Å‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏ï‡∏£‡∏ß‡∏à‡πÄ‡∏´‡∏£‡∏µ‡∏¢‡∏ç
volatile int pens = 0;                       // ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏õ‡∏≤‡∏Å‡∏Å‡∏≤‡∏ó‡∏µ‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏ã‡∏∑‡πâ‡∏≠‡πÑ‡∏î‡πâ
const unsigned long calculationDelay = 500;  // ‡πÄ‡∏ß‡∏•‡∏≤‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏á‡∏¥‡∏ô
const int pricePen = 8;                      // ‡∏£‡∏≤‡∏Ñ‡∏≤‡∏Ç‡∏≠‡∏á‡∏õ‡∏≤‡∏Å‡∏Å‡∏≤

// ‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£‡∏ó‡∏µ‡πà‡∏à‡∏∞‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏ó‡∏µ‡πà‡∏õ‡∏≤‡∏Å‡∏Å‡∏≤‡πÉ‡∏™‡πà‡πÑ‡∏î‡πâ
int amountBluePen = 10;              // ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏õ‡∏≤‡∏Å‡∏Å‡∏≤‡∏™‡∏µ‡∏ô‡πâ‡∏≥‡πÄ‡∏á‡∏¥‡∏ô‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏≠‡∏¢‡∏π‡πà
int amountRedPen = 10;               // ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏õ‡∏≤‡∏Å‡∏Å‡∏≤‡∏™‡∏µ‡πÅ‡∏î‡∏á‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏≠‡∏¢‡∏π‡πà
int bluePenPurchased = 0;            // ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏õ‡∏≤‡∏Å‡∏Å‡∏≤‡∏™‡∏µ‡∏ô‡πâ‡∏≥‡πÄ‡∏á‡∏¥‡∏ô‡∏ó‡∏µ‡πà‡∏ã‡∏∑‡πâ‡∏≠‡πÑ‡∏õ‡πÅ‡∏•‡πâ‡∏ß
int redPenPurchased = 0;             // ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏õ‡∏≤‡∏Å‡∏Å‡∏≤‡∏™‡∏µ‡πÅ‡∏î‡∏á‡∏ó‡∏µ‡πà‡∏ã‡∏∑‡πâ‡∏≠‡πÑ‡∏õ‡πÅ‡∏•‡πâ‡∏ß
unsigned long previousMillisPen = 0; // ‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏ö‡πÄ‡∏ß‡∏•‡∏≤‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Å‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏Ç‡∏≤‡∏¢‡∏õ‡∏≤‡∏Å‡∏Å‡∏≤
const long intervalPen = 5000;       // ‡∏ä‡πà‡∏ß‡∏á‡πÄ‡∏ß‡∏•‡∏≤‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Å‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏Ç‡∏≤‡∏¢‡∏õ‡∏≤‡∏Å‡∏Å‡∏≤ (5 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ)

// ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏û‡∏¥‡∏ô‡πÅ‡∏•‡∏∞‡∏Ñ‡πà‡∏≤‡∏ï‡πà‡∏≤‡∏á ‡πÜ ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏°‡πÄ‡∏ã‡∏≠‡∏£‡πå‡πÇ‡∏ß‡∏°‡∏≠‡πÄ‡∏ï‡∏≠‡∏£‡πå
Servo servo1; // ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏≠‡πá‡∏≠‡∏ö‡πÄ‡∏à‡πá‡∏Å‡∏ï‡πå‡πÄ‡∏ã‡∏≠‡∏£‡πå‡πÇ‡∏ß‡∏°‡∏≠‡πÄ‡∏ï‡∏≠‡∏£‡πå 1
Servo servo2; // ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏≠‡πá‡∏≠‡∏ö‡πÄ‡∏à‡πá‡∏Å‡∏ï‡πå‡πÄ‡∏ã‡∏≠‡∏£‡πå‡πÇ‡∏ß‡∏°‡∏≠‡πÄ‡∏ï‡∏≠‡∏£‡πå 2

const int servoPin1 = 25; // ‡∏û‡∏¥‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏Å‡∏±‡∏ö‡πÄ‡∏ã‡∏≠‡∏£‡πå‡πÇ‡∏ß‡∏°‡∏≠‡πÄ‡∏ï‡∏≠‡∏£‡πå 1
const int servoPin2 = 26; // ‡∏û‡∏¥‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏Å‡∏±‡∏ö‡πÄ‡∏ã‡∏≠‡∏£‡πå‡πÇ‡∏ß‡∏°‡∏≠‡πÄ‡∏ï‡∏≠‡∏£‡πå 2

const int RIGHT = 0;           // ‡∏°‡∏∏‡∏°‡∏Å‡∏≤‡∏£‡∏´‡∏°‡∏∏‡∏ô‡πÄ‡∏ã‡∏≠‡∏£‡πå‡πÇ‡∏ß‡∏°‡∏≠‡πÄ‡∏ï‡∏≠‡∏£‡πå‡πÑ‡∏õ‡∏ó‡∏≤‡∏á‡∏Ç‡∏ß‡∏≤
const int LEFT = 180;          // ‡∏°‡∏∏‡∏°‡∏Å‡∏≤‡∏£‡∏´‡∏°‡∏∏‡∏ô‡πÄ‡∏ã‡∏≠‡∏£‡πå‡πÇ‡∏ß‡∏°‡∏≠‡πÄ‡∏ï‡∏≠‡∏£‡πå‡πÑ‡∏õ‡∏ó‡∏≤‡∏á‡∏ã‡πâ‡∏≤‡∏¢
const int STOP = 90;           // ‡∏°‡∏∏‡∏°‡∏Å‡∏≤‡∏£‡∏´‡∏¢‡∏∏‡∏î‡∏Å‡∏≤‡∏£‡∏´‡∏°‡∏∏‡∏ô‡∏Ç‡∏≠‡∏á‡πÄ‡∏ã‡∏≠‡∏£‡πå‡πÇ‡∏ß‡∏°‡∏≠‡πÄ‡∏ï‡∏≠‡∏£‡πå
const int DELAY_SERVO1 = 1000; // ‡πÄ‡∏ß‡∏•‡∏≤‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏´‡∏ô‡πà‡∏ß‡∏á‡∏Ç‡∏≠‡∏á‡πÄ‡∏ã‡∏≠‡∏£‡πå‡πÇ‡∏ß‡∏°‡∏≠‡πÄ‡∏ï‡∏≠‡∏£‡πå 1
const int DELAY_SERVO2 = 1000; // ‡πÄ‡∏ß‡∏•‡∏≤‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏´‡∏ô‡πà‡∏ß‡∏á‡∏Ç‡∏≠‡∏á‡πÄ‡∏ã‡∏≠‡∏£‡πå‡πÇ‡∏ß‡∏°‡∏≠‡πÄ‡∏ï‡∏≠‡∏£‡πå 2

// ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏û‡∏¥‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏õ‡∏∏‡πà‡∏°‡∏£‡∏±‡∏ö‡∏õ‡∏≤‡∏Å‡∏Å‡∏≤‡∏™‡∏µ‡∏ô‡πâ‡∏≥‡πÄ‡∏á‡∏¥‡∏ô‡πÅ‡∏•‡∏∞‡∏™‡∏µ‡πÅ‡∏î‡∏á
const int buttonGetBluePen = 32;         // ‡∏û‡∏¥‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏Å‡∏±‡∏ö‡∏õ‡∏∏‡πà‡∏°‡∏£‡∏±‡∏ö‡∏õ‡∏≤‡∏Å‡∏Å‡∏≤‡∏™‡∏µ‡∏ô‡πâ‡∏≥‡πÄ‡∏á‡∏¥‡∏ô
const int buttonGetRedPen = 33;          // ‡∏û‡∏¥‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏Å‡∏±‡∏ö‡∏õ‡∏∏‡πà‡∏°‡∏£‡∏±‡∏ö‡∏õ‡∏≤‡∏Å‡∏Å‡∏≤‡∏™‡∏µ‡πÅ‡∏î‡∏á
bool lastState_buttonGetBluePen = false; // ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î‡∏Ç‡∏≠‡∏á‡∏õ‡∏∏‡πà‡∏°‡∏£‡∏±‡∏ö‡∏õ‡∏≤‡∏Å‡∏Å‡∏≤‡∏™‡∏µ‡∏ô‡πâ‡∏≥‡πÄ‡∏á‡∏¥‡∏ô
bool lastState_buttonGetRedPen = false;  // ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î‡∏Ç‡∏≠‡∏á‡∏õ‡∏∏‡πà‡∏°‡∏£‡∏±‡∏ö‡∏õ‡∏≤‡∏Å‡∏Å‡∏≤‡∏™‡∏µ‡πÅ‡∏î‡∏á

// ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏û‡∏¥‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏£‡∏µ‡πÄ‡∏•‡∏¢‡πå‡∏ó‡∏µ‡πà‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏°‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏à‡πà‡∏≤‡∏¢‡πÄ‡∏´‡∏£‡∏µ‡∏¢‡∏ç‡πÅ‡∏•‡∏∞‡∏£‡∏∞‡∏ö‡∏ö‡∏ï‡∏£‡∏ß‡∏à‡πÄ‡∏´‡∏£‡∏µ‡∏¢‡∏ç
const int relayPin3V = 27;            // ‡∏û‡∏¥‡∏ô‡∏ó‡∏µ‡πà‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏°‡∏£‡∏µ‡πÄ‡∏•‡∏¢‡πå 3V
bool relayState = false;              // ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Ç‡∏≠‡∏á‡∏£‡∏µ‡πÄ‡∏•‡∏¢‡πå 3V
const int relayPin12V = 14;           // ‡∏û‡∏¥‡∏ô‡∏ó‡∏µ‡πà‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏°‡∏£‡∏µ‡πÄ‡∏•‡∏¢‡πå 12V
bool relayCoinValidatorState = false; // ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Ç‡∏≠‡∏á‡∏£‡∏µ‡πÄ‡∏•‡∏¢‡πå 12V

// ‡∏ó‡∏≥‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏®‡∏ü‡∏±‡∏á‡∏ä‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏à‡∏∞‡∏ó‡∏≥‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡πÉ‡∏ä‡πâ‡∏Ç‡∏∂‡πâ‡∏ô‡∏°‡∏≤‡∏Å‡πà‡∏≠‡∏ô
void IRAM_ATTR doCounter();                                    // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏ô‡∏±‡∏ö‡∏û‡∏±‡∏•‡∏™‡πå‡∏à‡∏≤‡∏Å‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏ï‡∏£‡∏ß‡∏à‡πÄ‡∏´‡∏£‡∏µ‡∏¢‡∏ç
void updateDisplay();                                          // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏≠‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•
void refillDisplay();                                          // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÅ‡∏à‡πâ‡∏á‡πÉ‡∏´‡πâ‡πÄ‡∏ï‡∏¥‡∏°‡∏õ‡∏≤‡∏Å‡∏Å‡∏≤
void calculateAmount();                                        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏á‡∏¥‡∏ô‡∏à‡∏≤‡∏Å‡∏Å‡∏≤‡∏£‡∏ô‡∏±‡∏ö‡∏û‡∏±‡∏•‡∏™‡πå
void purchasPen(String PenColor);                              // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏à‡∏≥‡∏´‡∏ô‡πà‡∏≤‡∏¢‡∏õ‡∏≤‡∏Å‡∏Å‡∏≤
void sendLineNotify(String message, String imageUrl = "");     // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏™‡πà‡∏á‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡πÑ‡∏õ‡∏ó‡∏µ‡πà LINE Notify
void moveServo(String servoName, int targetDeg, int duration); // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏°‡∏Å‡∏≤‡∏£‡∏´‡∏°‡∏∏‡∏ô‡∏Ç‡∏≠‡∏á‡πÄ‡∏ã‡∏≠‡∏£‡πå‡πÇ‡∏ß‡∏°‡∏≠‡πÄ‡∏ï‡∏≠‡∏£‡πå
void checkbuttonPurchase();                                    // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏õ‡∏∏‡πà‡∏°
void releaseBluePen();                                         // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏à‡∏≥‡∏´‡∏ô‡πà‡∏≤‡∏¢‡∏õ‡∏≤‡∏Å‡∏Å‡∏≤‡∏™‡∏µ‡∏ô‡πâ‡∏≥‡πÄ‡∏á‡∏¥‡∏ô
void releaseRedPen();                                          // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏à‡∏≥‡∏´‡∏ô‡πà‡∏≤‡∏¢‡∏õ‡∏≤‡∏Å‡∏Å‡∏≤‡∏™‡∏µ‡πÅ‡∏î‡∏á
void disconnectCoinValidator();                                // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏ï‡∏±‡∏î‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏ï‡∏£‡∏ß‡∏à‡πÄ‡∏´‡∏£‡∏µ‡∏¢‡∏ç
void connectCoinValidator();                                   // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏ï‡∏£‡∏ß‡∏à‡πÄ‡∏´‡∏£‡∏µ‡∏¢‡∏ç

// WiFiManager ‡πÉ‡∏ä‡πâ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£ WiFi
WiFiManager wm;                                // ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏≠‡πá‡∏≠‡∏ö‡πÄ‡∏à‡πá‡∏Å‡∏ï‡πå WiFiManager
unsigned long connectStartTime;                // ‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£‡∏à‡∏±‡∏ö‡πÄ‡∏ß‡∏•‡∏≤‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠ WiFi
const unsigned long CONNECTION_TIMEOUT = 5000; // ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡πÄ‡∏ß‡∏•‡∏≤‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠ WiFi (5 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ)

void setup()
{
  Serial.begin(115200); // ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠ Serial ‡∏ó‡∏µ‡πà 115200 bps
  lcd.begin(16, 2);     // ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏Ç‡∏≠‡∏á‡∏à‡∏≠ LCD ‡∏Ç‡∏ô‡∏≤‡∏î 16x2
  lcd.backlight();      // ‡πÄ‡∏õ‡∏¥‡∏î‡πÑ‡∏ü‡πÅ‡∏ö‡πá‡∏Ñ‡πÑ‡∏•‡∏ó‡πå‡∏Ç‡∏≠‡∏á‡∏à‡∏≠ LCD

  pinMode(coinValidatorPin, INPUT_PULLUP); // ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏Ç‡∏≤ coinValidatorPin ‡πÄ‡∏õ‡πá‡∏ô INPUT_PULLUP
  disconnectCoinValidator();               // ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡πÉ‡∏ä‡πâ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô disconnectCoinValidator()

  pinMode(relayPin12V, OUTPUT);   // ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏Ç‡∏≤ relayPin12V ‡πÄ‡∏õ‡πá‡∏ô OUTPUT
  digitalWrite(relayPin12V, LOW); // ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏Ç‡∏≤ relayPin12V ‡πÉ‡∏´‡πâ‡πÄ‡∏õ‡πá‡∏ô LOW

  lcd.setCursor(0, 0);           // ‡∏ï‡∏±‡πâ‡∏á‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏Ç‡∏≠‡∏á‡πÄ‡∏Ñ‡∏≠‡∏£‡πå‡πÄ‡∏ã‡∏≠‡∏£‡πå‡∏ó‡∏µ‡πà‡πÅ‡∏ñ‡∏ß 0 ‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå 0
  lcd.print("System Starting."); // ‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏° "System Starting." ‡∏ö‡∏ô‡∏à‡∏≠ LCD
  delay(500);                    // ‡∏£‡∏≠ 500 ‡∏°‡∏¥‡∏•‡∏•‡∏¥‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ
  lcd.clear();                   // ‡∏•‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ö‡∏ô‡∏à‡∏≠ LCD

  lcd.setCursor(1, 0);         // ‡∏ï‡∏±‡πâ‡∏á‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏Ç‡∏≠‡∏á‡πÄ‡∏Ñ‡∏≠‡∏£‡πå‡πÄ‡∏ã‡∏≠‡∏£‡πå‡∏ó‡∏µ‡πà‡πÅ‡∏ñ‡∏ß 0 ‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå 1
  lcd.print("Please Connect"); // ‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏° "Please Connect" ‡∏ö‡∏ô‡∏à‡∏≠ LCD
  lcd.setCursor(5, 1);         // ‡∏ï‡∏±‡πâ‡∏á‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏Ç‡∏≠‡∏á‡πÄ‡∏Ñ‡∏≠‡∏£‡πå‡πÄ‡∏ã‡∏≠‡∏£‡πå‡∏ó‡∏µ‡πà‡πÅ‡∏ñ‡∏ß 1 ‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå 5
  lcd.print("WiFi...");        // ‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏° "WiFi..." ‡∏ö‡∏ô‡∏à‡∏≠ LCD
  delay(1000);                 // ‡∏£‡∏≠ 1000 ‡∏°‡∏¥‡∏•‡∏•‡∏¥‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ
  lcd.clear();                 // ‡∏•‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ö‡∏ô‡∏à‡∏≠ LCD

  bool res; // ‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏®‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£ bool ‡∏ä‡∏∑‡πà‡∏≠ res

  IPAddress staticIP(192, 168, 4, 1);                // ‡∏Å‡∏≥‡∏´‡∏ô‡∏î IP address ‡πÅ‡∏ö‡∏ö static
  IPAddress gateway(192, 168, 4, 1);                 // ‡∏Å‡∏≥‡∏´‡∏ô‡∏î gateway address
  IPAddress subnet(255, 255, 255, 0);                // ‡∏Å‡∏≥‡∏´‡∏ô‡∏î subnet mask
  wm.setAPStaticIPConfig(staticIP, gateway, subnet); // ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ static IP configuration

  lcd.clear();                 // ‡∏•‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ö‡∏ô‡∏à‡∏≠ LCD
  lcd.setCursor(6, 0);         // ‡∏ï‡∏±‡πâ‡∏á‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏Ç‡∏≠‡∏á‡πÄ‡∏Ñ‡∏≠‡∏£‡πå‡πÄ‡∏ã‡∏≠‡∏£‡πå‡∏ó‡∏µ‡πà‡πÅ‡∏ñ‡∏ß 0 ‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå 6
  lcd.print("WiFi");           // ‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏° "WiFi" ‡∏ö‡∏ô‡∏à‡∏≠ LCD
  lcd.setCursor(2, 1);         // ‡∏ï‡∏±‡πâ‡∏á‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏Ç‡∏≠‡∏á‡πÄ‡∏Ñ‡∏≠‡∏£‡πå‡πÄ‡∏ã‡∏≠‡∏£‡πå‡∏ó‡∏µ‡πà‡πÅ‡∏ñ‡∏ß 1 ‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå 2
  lcd.print("Connecting..");   // ‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏° "Connecting.." ‡∏ö‡∏ô‡∏à‡∏≠ LCD
  connectStartTime = millis(); // ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÄ‡∏ß‡∏•‡∏≤‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏ä‡πâ‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠

  wm.setTimeout(30); // ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡πÄ‡∏ß‡∏•‡∏≤ timeout ‡πÄ‡∏õ‡πá‡∏ô 30 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ

  if (!wm.autoConnect(WIFI_NAME, WIFI_PASSWORD)) // ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠ WiFi ‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥
  {
    unsigned long elapsedTime = millis() - connectStartTime; // ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡πÄ‡∏ß‡∏•‡∏≤‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠
    if (elapsedTime >= CONNECTION_TIMEOUT)                   // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡πÄ‡∏Å‡∏¥‡∏ô 30 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà
    {
      Serial.println("Failed to connect within 30 seconds"); // ‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÉ‡∏ô Serial monitor ‡∏´‡∏≤‡∏Å‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à
      lcd.clear();                                           // ‡∏•‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ö‡∏ô‡∏à‡∏≠ LCD
      lcd.setCursor(0, 0);                                   // ‡∏ï‡∏±‡πâ‡∏á‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏Ç‡∏≠‡∏á‡πÄ‡∏Ñ‡∏≠‡∏£‡πå‡πÄ‡∏ã‡∏≠‡∏£‡πå‡∏ó‡∏µ‡πà‡πÅ‡∏ñ‡∏ß 0 ‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå 0
      lcd.print("AP Mode Active");                           // ‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏° "AP Mode Active" ‡∏ö‡∏ô‡∏à‡∏≠ LCD
      lcd.setCursor(0, 1);                                   // ‡∏ï‡∏±‡πâ‡∏á‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏Ç‡∏≠‡∏á‡πÄ‡∏Ñ‡∏≠‡∏£‡πå‡πÄ‡∏ã‡∏≠‡∏£‡πå‡∏ó‡∏µ‡πà‡πÅ‡∏ñ‡∏ß 1 ‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå 0
      lcd.print("Connect to WiFi");                          // ‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏° "Connect to WiFi" ‡∏ö‡∏ô‡∏à‡∏≠ LCD
      delay(1000);                                           // ‡∏£‡∏≠ 1000 ‡∏°‡∏¥‡∏•‡∏•‡∏¥‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ
      ESP.restart();                                         // ‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï ESP
    }
  }
  else // ‡∏´‡∏≤‡∏Å‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à
  {
    sendLineNotify("‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏Å‡∏±‡∏ö‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏Ç‡∏≤‡∏¢‡∏õ‡∏≤‡∏Å‡∏Å‡∏≤‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à‡πÅ‡∏•‡πâ‡∏ß! ‚úÖ", "‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡∏û‡∏û‡∏û‡∏û"); // ‡∏™‡πà‡∏á‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏ú‡πà‡∏≤‡∏ô Line
    Serial.println("‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à‡πÅ‡∏•‡πâ‡∏ß!");                                                                                                                                                                                              // ‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÉ‡∏ô Serial monitor ‡∏ß‡πà‡∏≤‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à
    lcd.clear();                                                                                                                                                                                                                    // ‡∏•‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ö‡∏ô‡∏à‡∏≠ LCD
    lcd.setCursor(6, 0);                                                                                                                                                                                                            // ‡∏ï‡∏±‡πâ‡∏á‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏Ç‡∏≠‡∏á‡πÄ‡∏Ñ‡∏≠‡∏£‡πå‡πÄ‡∏ã‡∏≠‡∏£‡πå‡∏ó‡∏µ‡πà‡πÅ‡∏ñ‡∏ß 0 ‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå 6
    lcd.print("WiFi");                                                                                                                                                                                                              // ‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏° "WiFi" ‡∏ö‡∏ô‡∏à‡∏≠ LCD
    lcd.setCursor(3, 1);                                                                                                                                                                                                            // ‡∏ï‡∏±‡πâ‡∏á‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏Ç‡∏≠‡∏á‡πÄ‡∏Ñ‡∏≠‡∏£‡πå‡πÄ‡∏ã‡∏≠‡∏£‡πå‡∏ó‡∏µ‡πà‡πÅ‡∏ñ‡∏ß 1 ‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå 3
    lcd.print("Connected!");                                                                                                                                                                                                        // ‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏° "Connected!" ‡∏ö‡∏ô‡∏à‡∏≠ LCD
    Blynk.config(BLYNK_AUTH_TOKEN);                                                                                                                                                                                                 // ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏Ñ‡πà‡∏≤ Blynk ‡∏î‡πâ‡∏ß‡∏¢ BLYNK_AUTH_TOKEN
    delay(2000);                                                                                                                                                                                                                    // ‡∏£‡∏≠ 2000 ‡∏°‡∏¥‡∏•‡∏•‡∏¥‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ
  }

  pinMode(relayPin3V, OUTPUT);     // ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏Ç‡∏≤ relayPin3V ‡πÄ‡∏õ‡πá‡∏ô OUTPUT
  digitalWrite(relayPin3V, HIGH);  // ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏Ç‡∏≤ relayPin3V ‡πÉ‡∏´‡πâ‡πÄ‡∏õ‡πá‡∏ô HIGH
  digitalWrite(relayPin12V, HIGH); // ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏Ç‡∏≤ relayPin12V ‡πÉ‡∏´‡πâ‡πÄ‡∏õ‡πá‡∏ô HIGH

  servo1.attach(servoPin1); // ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠ servo1 ‡∏Å‡∏±‡∏ö‡∏Ç‡∏≤ servoPin1
  servo2.attach(servoPin2); // ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠ servo2 ‡∏Å‡∏±‡∏ö‡∏Ç‡∏≤ servoPin2

  pinMode(buttonGetBluePen, INPUT_PULLUP); // ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏Ç‡∏≤ buttonGetBluePen ‡πÄ‡∏õ‡πá‡∏ô INPUT_PULLUP
  pinMode(buttonGetRedPen, INPUT_PULLUP);  // ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏Ç‡∏≤ buttonGetRedPen ‡πÄ‡∏õ‡πá‡∏ô INPUT_PULLUP

  updateDisplay(); // ‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ï‡∏Å‡∏≤‡∏£‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡∏ö‡∏ô‡∏à‡∏≠ LCD

  Blynk.virtualWrite(V5, 1); // ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡∏Ñ‡πà‡∏≤‡∏•‡∏á‡πÉ‡∏ô Blynk virtual pin V5

  delay(2000);            // ‡∏£‡∏≠ 2000 ‡∏°‡∏¥‡∏•‡∏•‡∏¥‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ
  connectCoinValidator(); // ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠ coin validator
}

void loop()
{
  Blynk.run(); // ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡πÉ‡∏ä‡πâ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô Blynk.run() ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ï Blynk

  if (!relayCoinValidatorState) // ‡∏´‡∏≤‡∏Å relayCoinValidatorState ‡πÄ‡∏õ‡πá‡∏ô false
  {
    unsigned long currentMillisPen = millis();               // ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÄ‡∏ß‡∏•‡∏≤‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô
    if (currentMillisPen - previousMillisPen >= intervalPen) // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÄ‡∏ß‡∏•‡∏≤‡∏ó‡∏µ‡πà‡∏ú‡πà‡∏≤‡∏ô‡∏°‡∏≤
    {
      if (bluePenPurchased > 0 || redPenPurchased > 0) // ‡∏´‡∏≤‡∏Å‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡∏ã‡∏∑‡πâ‡∏≠‡∏õ‡∏≤‡∏Å‡∏Å‡∏≤‡∏™‡∏µ‡∏ü‡πâ‡∏≤‡∏´‡∏£‡∏∑‡∏≠‡∏™‡∏µ‡πÅ‡∏î‡∏á
      {
        String message = "";      // ‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏®‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£ message ‡πÄ‡∏õ‡πá‡∏ô‡∏™‡∏ï‡∏£‡∏¥‡∏á‡∏ß‡πà‡∏≤‡∏á
        if (bluePenPurchased > 0) // ‡∏´‡∏≤‡∏Å‡∏ã‡∏∑‡πâ‡∏≠‡∏õ‡∏≤‡∏Å‡∏Å‡∏≤‡∏™‡∏µ‡∏ü‡πâ‡∏≤
        {
          message += "\nüîµ ‡∏à‡∏≥‡∏´‡∏ô‡πà‡∏≤‡∏¢‡∏õ‡∏≤‡∏Å‡∏Å‡∏≤‡∏™‡∏µ‡∏ô‡πâ‡∏≥‡πÄ‡∏á‡∏¥‡∏ô " + String(bluePenPurchased) + " ‡∏î‡πâ‡∏≤‡∏°\n"; // ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏•‡∏á‡πÉ‡∏ô message
        }
        if (redPenPurchased > 0) // ‡∏´‡∏≤‡∏Å‡∏ã‡∏∑‡πâ‡∏≠‡∏õ‡∏≤‡∏Å‡∏Å‡∏≤‡∏™‡∏µ‡πÅ‡∏î‡∏á
        {
          message += "\nüî¥ ‡∏à‡∏≥‡∏´‡∏ô‡πà‡∏≤‡∏¢‡∏õ‡∏≤‡∏Å‡∏Å‡∏≤‡∏™‡∏µ‡πÅ‡∏î‡∏á " + String(redPenPurchased) + " ‡∏î‡πâ‡∏≤‡∏°"; // ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏•‡∏á‡πÉ‡∏ô message
        }
        sendLineNotify(message); // ‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ú‡πà‡∏≤‡∏ô Line Notify

        bluePenPurchased = 0; // ‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏õ‡∏≤‡∏Å‡∏Å‡∏≤‡∏™‡∏µ‡∏ô‡πâ‡∏≥‡πÄ‡∏á‡∏¥‡∏ô‡∏ó‡∏µ‡πà‡∏ã‡∏∑‡πâ‡∏≠
        redPenPurchased = 0;  // ‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏õ‡∏≤‡∏Å‡∏Å‡∏≤‡∏™‡∏µ‡πÅ‡∏î‡∏á‡∏ó‡∏µ‡πà‡∏ã‡∏∑‡πâ‡∏≠
      }
      previousMillisPen = currentMillisPen; // ‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ï‡πÄ‡∏ß‡∏•‡∏≤‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö
    }

    static unsigned long lastCalculationTime = 0; // ‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏®‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£ static ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÄ‡∏Å‡πá‡∏ö‡πÄ‡∏ß‡∏•‡∏≤‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î
    unsigned long currentTime = millis();         // ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÄ‡∏ß‡∏•‡∏≤‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô

    if (pulseCount > 0 && (currentTime - lastDebounceTime) > calculationDelay) // ‡∏´‡∏≤‡∏Å‡∏°‡∏µ pulseCount ‡∏°‡∏≤‡∏Å‡∏Å‡∏ß‡πà‡∏≤ 0 ‡πÅ‡∏•‡∏∞‡πÄ‡∏ß‡∏•‡∏≤‡∏ó‡∏µ‡πà‡∏ú‡πà‡∏≤‡∏ô‡∏°‡∏≤‡πÄ‡∏Å‡∏¥‡∏ô delay
    {
      calculateAmount();                 // ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏á‡∏¥‡∏ô
      lastCalculationTime = currentTime; // ‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ï‡πÄ‡∏ß‡∏•‡∏≤‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î
    }

    checkbuttonPurchase(); // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏õ‡∏∏‡πà‡∏°‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ã‡∏∑‡πâ‡∏≠‡∏õ‡∏≤‡∏Å‡∏Å‡∏≤

    if (pens > 0) // ‡∏´‡∏≤‡∏Å‡∏°‡∏µ‡∏õ‡∏≤‡∏Å‡∏Å‡∏≤‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠
    {
      digitalWrite(relayPin3V, LOW); // ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏Ç‡∏≤ relayPin3V ‡πÄ‡∏õ‡πá‡∏ô LOW
    }
    else
    {
      digitalWrite(relayPin3V, HIGH); // ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏Ç‡∏≤ relayPin3V ‡πÄ‡∏õ‡πá‡∏ô HIGH
    }
  }
  else // ‡∏´‡∏≤‡∏Å relayCoinValidatorState ‡πÄ‡∏õ‡πá‡∏ô true
  {
    lcd.clear();               // ‡∏•‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ö‡∏ô‡∏à‡∏≠ LCD
    lcd.setCursor(2, 0);       // ‡∏ï‡∏±‡πâ‡∏á‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏Ç‡∏≠‡∏á‡πÄ‡∏Ñ‡∏≠‡∏£‡πå‡πÄ‡∏ã‡∏≠‡∏£‡πå‡∏ó‡∏µ‡πà‡πÅ‡∏ñ‡∏ß 0 ‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå 2
    lcd.print("System: OFF!"); // ‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏° "System: OFF!" ‡∏ö‡∏ô‡∏à‡∏≠ LCD
  }
}

void checkbuttonPurchase()
{
  if (digitalRead(buttonGetBluePen) == LOW && !lastState_buttonGetBluePen) // ‡∏´‡∏≤‡∏Å‡∏õ‡∏∏‡πà‡∏°‡∏ã‡∏∑‡πâ‡∏≠‡∏õ‡∏≤‡∏Å‡∏Å‡∏≤‡∏™‡∏µ‡∏ô‡πâ‡∏≥‡πÄ‡∏á‡∏¥‡∏ô‡∏ñ‡∏π‡∏Å‡∏Å‡∏î‡πÅ‡∏•‡∏∞‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏õ‡∏∏‡πà‡∏°‡∏Å‡πà‡∏≠‡∏ô‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏õ‡πá‡∏ô false
  {
    if (amountBluePen != 0) // ‡∏´‡∏≤‡∏Å‡∏°‡∏µ‡∏õ‡∏≤‡∏Å‡∏Å‡∏≤‡∏™‡∏µ‡∏ô‡πâ‡∏≥‡πÄ‡∏á‡∏¥‡∏ô‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠
    {
      lastState_buttonGetBluePen = true; // ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏õ‡∏∏‡πà‡∏°‡πÄ‡∏õ‡πá‡∏ô true
      purchasPen("blue");                // ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡πÉ‡∏ä‡πâ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô purchasPen() ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏õ‡∏≤‡∏Å‡∏Å‡∏≤‡∏™‡∏µ‡∏ô‡πâ‡∏≥‡πÄ‡∏á‡∏¥‡∏ô
    }
    else
    {
      refillDisplay(); // ‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ß‡πà‡∏≤‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏ï‡∏¥‡∏°‡∏õ‡∏≤‡∏Å‡∏Å‡∏≤
    }
  }
  if (digitalRead(buttonGetRedPen) == LOW && !lastState_buttonGetRedPen) // ‡∏´‡∏≤‡∏Å‡∏õ‡∏∏‡πà‡∏°‡∏ã‡∏∑‡πâ‡∏≠‡∏õ‡∏≤‡∏Å‡∏Å‡∏≤‡∏™‡∏µ‡πÅ‡∏î‡∏á‡∏ñ‡∏π‡∏Å‡∏Å‡∏î‡πÅ‡∏•‡∏∞‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏õ‡∏∏‡πà‡∏°‡∏Å‡πà‡∏≠‡∏ô‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏õ‡πá‡∏ô false
  {
    if (amountRedPen != 0) // ‡∏´‡∏≤‡∏Å‡∏°‡∏µ‡∏õ‡∏≤‡∏Å‡∏Å‡∏≤‡∏™‡∏µ‡πÅ‡∏î‡∏á‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠
    {
      lastState_buttonGetRedPen = true; // ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏õ‡∏∏‡πà‡∏°‡πÄ‡∏õ‡πá‡∏ô true
      purchasPen("red");                // ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡πÉ‡∏ä‡πâ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô purchasPen() ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏õ‡∏≤‡∏Å‡∏Å‡∏≤‡∏™‡∏µ‡πÅ‡∏î‡∏á
    }
  }
  if (digitalRead(buttonGetBluePen) == HIGH) // ‡∏´‡∏≤‡∏Å‡∏õ‡∏∏‡πà‡∏°‡∏ã‡∏∑‡πâ‡∏≠‡∏õ‡∏≤‡∏Å‡∏Å‡∏≤‡∏™‡∏µ‡∏ô‡πâ‡∏≥‡πÄ‡∏á‡∏¥‡∏ô‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏Å‡∏î
  {
    lastState_buttonGetBluePen = false; // ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏õ‡∏∏‡πà‡∏°‡πÄ‡∏õ‡πá‡∏ô false
  }
  if (digitalRead(buttonGetRedPen) == HIGH) // ‡∏´‡∏≤‡∏Å‡∏õ‡∏∏‡πà‡∏°‡∏ã‡∏∑‡πâ‡∏≠‡∏õ‡∏≤‡∏Å‡∏Å‡∏≤‡∏™‡∏µ‡πÅ‡∏î‡∏á‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏Å‡∏î
  {
    lastState_buttonGetRedPen = false; // ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏õ‡∏∏‡πà‡∏°‡πÄ‡∏õ‡πá‡∏ô false
  }
}

void moveServo(String servoName, int targetDeg, int duration)
{
  Servo *servo = (servoName == "blue") ? &servo1 : &servo2; // ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏ã‡∏≠‡∏£‡πå‡πÇ‡∏ß‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏ï‡∏≤‡∏°‡∏ä‡∏∑‡πà‡∏≠
  servo->write(targetDeg);                                  // ‡∏´‡∏°‡∏∏‡∏ô‡πÄ‡∏ã‡∏≠‡∏£‡πå‡πÇ‡∏ß‡πÑ‡∏õ‡∏¢‡∏±‡∏á‡∏°‡∏∏‡∏°‡∏ó‡∏µ‡πà‡∏Å‡∏≥‡∏´‡∏ô‡∏î
  delay(duration);                                          // ‡∏£‡∏≠‡∏£‡∏∞‡∏¢‡∏∞‡πÄ‡∏ß‡∏•‡∏≤‡∏ó‡∏µ‡πà‡∏Å‡∏≥‡∏´‡∏ô‡∏î
}

void IRAM_ATTR doCounter()
{
  unsigned long currentTime = millis();                 // ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÄ‡∏ß‡∏•‡∏≤‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô
  if ((currentTime - lastDebounceTime) > debounceDelay) // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÄ‡∏ß‡∏•‡∏≤‡∏ó‡∏µ‡πà‡∏ú‡πà‡∏≤‡∏ô‡∏°‡∏≤‡πÄ‡∏Å‡∏¥‡∏ô delay
  {
    pulseCount++;                   // ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏à‡∏≥‡∏ô‡∏ß‡∏ô pulse
    lastDebounceTime = currentTime; // ‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ï‡πÄ‡∏ß‡∏•‡∏≤‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö
  }
}

void updateDisplay()
{
  lcd.clear();          // ‡∏•‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ö‡∏ô‡∏à‡∏≠ LCD
  if (totalAmount == 0) // ‡∏´‡∏≤‡∏Å‡∏¢‡∏≠‡∏î‡πÄ‡∏á‡∏¥‡∏ô‡∏£‡∏ß‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡πÄ‡∏õ‡πá‡∏ô 0
  {
    lcd.setCursor(2, 0);       // ‡∏ï‡∏±‡πâ‡∏á‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏Ç‡∏≠‡∏á‡πÄ‡∏Ñ‡∏≠‡∏£‡πå‡πÄ‡∏ã‡∏≠‡∏£‡πå‡∏ó‡∏µ‡πà‡πÅ‡∏ñ‡∏ß 0 ‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå 2
    lcd.print("Insert Coin!"); // ‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏° "Insert Coin!" ‡∏ö‡∏ô‡∏à‡∏≠ LCD
  }
  else
  {
    lcd.setCursor(0, 0);                                    // ‡∏ï‡∏±‡πâ‡∏á‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏Ç‡∏≠‡∏á‡πÄ‡∏Ñ‡∏≠‡∏£‡πå‡πÄ‡∏ã‡∏≠‡∏£‡πå‡∏ó‡∏µ‡πà‡πÅ‡∏ñ‡∏ß 0 ‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå 0
    lcd.print("Total: " + String(totalAmount) + " Bath.-"); // ‡πÅ‡∏™‡∏î‡∏á‡∏¢‡∏≠‡∏î‡πÄ‡∏á‡∏¥‡∏ô‡∏£‡∏ß‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
    lcd.setCursor(0, 1);                                    // ‡∏ï‡∏±‡πâ‡∏á‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏Ç‡∏≠‡∏á‡πÄ‡∏Ñ‡∏≠‡∏£‡πå‡πÄ‡∏ã‡∏≠‡∏£‡πå‡∏ó‡∏µ‡πà‡πÅ‡∏ñ‡∏ß 1 ‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå 0
    lcd.print("Pens: " + String(pens));                     // ‡πÅ‡∏™‡∏î‡∏á‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏õ‡∏≤‡∏Å‡∏Å‡∏≤
  }
  delay(100); // ‡∏£‡∏≠ 100 ‡∏°‡∏¥‡∏•‡∏•‡∏¥‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ
}

void refillDisplay()
{
  lcd.clear();                   // ‡∏•‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ö‡∏ô‡∏à‡∏≠ LCD
  lcd.setCursor(0, 0);           // ‡∏ï‡∏±‡πâ‡∏á‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏Ç‡∏≠‡∏á‡πÄ‡∏Ñ‡∏≠‡∏£‡πå‡πÄ‡∏ã‡∏≠‡∏£‡πå‡∏ó‡∏µ‡πà‡πÅ‡∏ñ‡∏ß 0 ‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå 0
  lcd.print("Can't buy a Pen");  // ‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏° "Can't buy a Pen" ‡∏ö‡∏ô‡∏à‡∏≠ LCD
  lcd.setCursor(0, 1);           // ‡∏ï‡∏±‡πâ‡∏á‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏Ç‡∏≠‡∏á‡πÄ‡∏Ñ‡∏≠‡∏£‡πå‡πÄ‡∏ã‡∏≠‡∏£‡πå‡∏ó‡∏µ‡πà‡πÅ‡∏ñ‡∏ß 1 ‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå 0
  lcd.print("Please refill it"); // ‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏° "Please refill it" ‡∏ö‡∏ô‡∏à‡∏≠ LCD
  delay(2000);                   // ‡∏£‡∏≠ 2000 ‡∏°‡∏¥‡∏•‡∏•‡∏¥‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ
}

void calculateAmount()
{
  if (pulseCount > 0) // ‡∏´‡∏≤‡∏Å‡∏°‡∏µ pulseCount ‡∏°‡∏≤‡∏Å‡∏Å‡∏ß‡πà‡∏≤ 0
  {
    Serial.print("‡∏à‡∏≥‡∏ô‡∏ß‡∏ô Pulse: " + String(pulseCount)); // ‡πÅ‡∏™‡∏î‡∏á‡∏à‡∏≥‡∏ô‡∏ß‡∏ô pulse ‡πÉ‡∏ô Serial monitor
    Serial.print("‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏á‡∏¥‡∏ô: ");                           // ‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏° "‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏á‡∏¥‡∏ô: " ‡πÉ‡∏ô Serial monitor

    if (pulseCount == 1) // ‡∏´‡∏≤‡∏Å pulseCount ‡πÄ‡∏ó‡πà‡∏≤‡∏Å‡∏±‡∏ö 1
    {
      totalAmount += 1;        // ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏á‡∏¥‡∏ô‡∏£‡∏ß‡∏° 1 ‡∏ö‡∏≤‡∏ó
      Serial.println("1 ‡∏ö‡∏≤‡∏ó"); // ‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏° "1 ‡∏ö‡∏≤‡∏ó" ‡πÉ‡∏ô Serial monitor
    }
    else if (pulseCount == 2) // ‡∏´‡∏≤‡∏Å pulseCount ‡πÄ‡∏ó‡πà‡∏≤‡∏Å‡∏±‡∏ö 2
    {
      totalAmount += 2;        // ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏á‡∏¥‡∏ô‡∏£‡∏ß‡∏° 2 ‡∏ö‡∏≤‡∏ó
      Serial.println("2 ‡∏ö‡∏≤‡∏ó"); // ‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏° "2 ‡∏ö‡∏≤‡∏ó" ‡πÉ‡∏ô Serial monitor
    }
    else if (pulseCount >= 3 && pulseCount < 5) // ‡∏´‡∏≤‡∏Å pulseCount ‡∏°‡∏≤‡∏Å‡∏Å‡∏ß‡πà‡∏≤‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏ó‡πà‡∏≤‡∏Å‡∏±‡∏ö 3 ‡πÅ‡∏ï‡πà‡∏ï‡πà‡∏≥‡∏Å‡∏ß‡πà‡∏≤ 5
    {
      totalAmount += 5;        // ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏á‡∏¥‡∏ô‡∏£‡∏ß‡∏° 5 ‡∏ö‡∏≤‡∏ó
      Serial.println("5 ‡∏ö‡∏≤‡∏ó"); // ‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏° "5 ‡∏ö‡∏≤‡∏ó" ‡πÉ‡∏ô Serial monitor
    }
    else if (pulseCount > 4) // ‡∏´‡∏≤‡∏Å pulseCount ‡∏°‡∏≤‡∏Å‡∏Å‡∏ß‡πà‡∏≤ 4
    {
      totalAmount += 10;        // ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏á‡∏¥‡∏ô‡∏£‡∏ß‡∏° 10 ‡∏ö‡∏≤‡∏ó
      Serial.println("10 ‡∏ö‡∏≤‡∏ó"); // ‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏° "10 ‡∏ö‡∏≤‡∏ó" ‡πÉ‡∏ô Serial monitor
    }
    else
    {
      totalAmount = 0;         // ‡∏´‡∏≤‡∏Å‡πÑ‡∏°‡πà‡∏ï‡∏£‡∏á‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏Ç‡πÉ‡∏î‡πÜ ‡πÉ‡∏´‡πâ‡∏¢‡∏≠‡∏î‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏õ‡πá‡∏ô 0
      Serial.println("0 ‡∏ö‡∏≤‡∏ó"); // ‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏° "0 ‡∏ö‡∏≤‡∏ó" ‡πÉ‡∏ô Serial monitor
    }

    if (totalAmount / pricePen > pens) // ‡∏´‡∏≤‡∏Å‡∏¢‡∏≠‡∏î‡πÄ‡∏á‡∏¥‡∏ô‡∏´‡∏≤‡∏£‡∏î‡πâ‡∏ß‡∏¢‡∏£‡∏≤‡∏Ñ‡∏≤‡∏õ‡∏≤‡∏Å‡∏Å‡∏≤‡∏°‡∏≤‡∏Å‡∏Å‡∏ß‡πà‡∏≤‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏õ‡∏≤‡∏Å‡∏Å‡∏≤‡∏ó‡∏µ‡πà‡∏°‡∏µ
    {
      pens = totalAmount / pricePen;               // ‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ï‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏õ‡∏≤‡∏Å‡∏Å‡∏≤‡∏ó‡∏µ‡πà‡∏°‡∏µ
      Serial.print("‡∏à‡∏≥‡∏ô‡∏ß‡∏ô pens: " + String(pens)); // ‡πÅ‡∏™‡∏î‡∏á‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏õ‡∏≤‡∏Å‡∏Å‡∏≤‡πÉ‡∏ô Serial monitor
    }

    pulseCount = 0; // ‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏à‡∏≥‡∏ô‡∏ß‡∏ô pulse

    Serial.print("‡∏¢‡∏≠‡∏î‡πÄ‡∏á‡∏¥‡∏ô‡∏£‡∏ß‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î: " + String(totalAmount) + " ‡∏ö‡∏≤‡∏ó"); // ‡πÅ‡∏™‡∏î‡∏á‡∏¢‡∏≠‡∏î‡πÄ‡∏á‡∏¥‡∏ô‡∏£‡∏ß‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡πÉ‡∏ô Serial monitor
    updateDisplay();                                                 // ‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ï‡∏Å‡∏≤‡∏£‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡∏ö‡∏ô‡∏à‡∏≠ LCD
  }
}

void purchasPen(String PenColor)
{
  if (pens >= 1) // ‡∏´‡∏≤‡∏Å‡∏°‡∏µ‡∏õ‡∏≤‡∏Å‡∏Å‡∏≤‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠
  {
    Serial.print("purches Pen!"); // ‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏° "purches Pen!" ‡πÉ‡∏ô Serial monitor

    lcd.clear();                   // ‡∏•‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ö‡∏ô‡∏à‡∏≠ LCD
    lcd.setCursor(0, 0);           // ‡∏ï‡∏±‡πâ‡∏á‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏Ç‡∏≠‡∏á‡πÄ‡∏Ñ‡∏≠‡∏£‡πå‡πÄ‡∏ã‡∏≠‡∏£‡πå‡∏ó‡∏µ‡πà‡πÅ‡∏ñ‡∏ß 0 ‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå 0
    lcd.print("You have success"); // ‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏° "You have success" ‡∏ö‡∏ô‡∏à‡∏≠ LCD
    lcd.setCursor(0, 1);           // ‡∏ï‡∏±‡πâ‡∏á‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏Ç‡∏≠‡∏á‡πÄ‡∏Ñ‡∏≠‡∏£‡πå‡πÄ‡∏ã‡∏≠‡∏£‡πå‡∏ó‡∏µ‡πà‡πÅ‡∏ñ‡∏ß 1 ‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå 0
    lcd.print("Purchased 1 pen!"); // ‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏° "Purchased 1 pen!" ‡∏ö‡∏ô‡∏à‡∏≠ LCD
    delay(50);                     // ‡∏£‡∏≠ 50 ‡∏°‡∏¥‡∏•‡∏•‡∏¥‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ

    pens -= 1;               // ‡∏•‡∏î‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏õ‡∏≤‡∏Å‡∏Å‡∏≤‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏•‡∏á 1 ‡∏≠‡∏±‡∏ô
    totalAmount -= pricePen; // ‡∏•‡∏î‡∏¢‡∏≠‡∏î‡πÄ‡∏á‡∏¥‡∏ô‡∏£‡∏ß‡∏°‡∏ï‡∏≤‡∏°‡∏£‡∏≤‡∏Ñ‡∏≤‡∏õ‡∏≤‡∏Å‡∏Å‡∏≤

    if (PenColor == "blue") // ‡∏´‡∏≤‡∏Å‡∏õ‡∏≤‡∏Å‡∏Å‡∏≤‡πÄ‡∏õ‡πá‡∏ô‡∏™‡∏µ‡∏ô‡πâ‡∏≥‡πÄ‡∏á‡∏¥‡∏ô
    {
      releaseBluePen();       // ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡πÉ‡∏ä‡πâ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô releaseBluePen()
      bluePenPurchased += 1;  // ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏õ‡∏≤‡∏Å‡∏Å‡∏≤‡∏™‡∏µ‡∏ô‡πâ‡∏≥‡πÄ‡∏á‡∏¥‡∏ô‡∏ó‡∏µ‡πà‡∏Ç‡∏≤‡∏¢‡πÑ‡∏õ‡πÅ‡∏•‡πâ‡∏ß
      amountBluePen -= 1;     // ‡∏•‡∏î‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏õ‡∏≤‡∏Å‡∏Å‡∏≤‡∏™‡∏µ‡∏ô‡πâ‡∏≥‡πÄ‡∏á‡∏¥‡∏ô‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠
      if (amountBluePen <= 5) // ‡∏´‡∏≤‡∏Å‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏õ‡∏≤‡∏Å‡∏Å‡∏≤‡∏™‡∏µ‡∏ô‡πâ‡∏≥‡πÄ‡∏á‡∏¥‡∏ô‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡πÑ‡∏°‡πà‡πÄ‡∏Å‡∏¥‡∏ô 5 ‡∏≠‡∏±‡∏ô
      {
        sendLineNotify("\nüîµ ‡∏õ‡∏≤‡∏Å‡∏Å‡∏≤‡∏™‡∏µ‡∏ô‡πâ‡∏≥‡πÄ‡∏á‡∏¥‡∏ô‡πÉ‡∏Å‡∏•‡πâ‡∏à‡∏∞‡∏´‡∏°‡∏î‡πÅ‡∏•‡πâ‡∏ß\n\n‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏´‡∏•‡∏∑‡∏≠: " + String(amountBluePen) + " ‡∏î‡πâ‡∏≤‡∏°"); // ‡∏™‡πà‡∏á‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô
      }
      if (amountBluePen == 0) // ‡∏´‡∏≤‡∏Å‡∏õ‡∏≤‡∏Å‡∏Å‡∏≤‡∏™‡∏µ‡∏ô‡πâ‡∏≥‡πÄ‡∏á‡∏¥‡∏ô‡∏´‡∏°‡∏î
      {
        sendLineNotify("\nüîµ ‡∏õ‡∏≤‡∏Å‡∏Å‡∏≤‡∏™‡∏µ‡∏ô‡πâ‡∏≥‡πÄ‡∏á‡∏¥‡∏ô‡∏´‡∏°‡∏î‡πÅ‡∏•‡πâ‡∏ß\n\n‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏ï‡∏¥‡∏°‡∏õ‡∏≤‡∏Å‡∏Å‡∏≤!!"); // ‡∏™‡πà‡∏á‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡πÉ‡∏´‡πâ‡πÄ‡∏ï‡∏¥‡∏°‡∏õ‡∏≤‡∏Å‡∏Å‡∏≤
        refillDisplay();                                            // ‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ß‡πà‡∏≤‡πÉ‡∏´‡πâ‡πÄ‡∏ï‡∏¥‡∏°‡∏õ‡∏≤‡∏Å‡∏Å‡∏≤
      }
    }
    else if (PenColor == "red") // ‡∏´‡∏≤‡∏Å‡∏õ‡∏≤‡∏Å‡∏Å‡∏≤‡πÄ‡∏õ‡πá‡∏ô‡∏™‡∏µ‡πÅ‡∏î‡∏á
    {
      releaseRedPen();       // ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡πÉ‡∏ä‡πâ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô releaseRedPen()
      redPenPurchased += 1;  // ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏õ‡∏≤‡∏Å‡∏Å‡∏≤‡∏™‡∏µ‡πÅ‡∏î‡∏á‡∏ó‡∏µ‡πà‡∏Ç‡∏≤‡∏¢‡πÑ‡∏õ‡πÅ‡∏•‡πâ‡∏ß
      amountRedPen -= 1;     // ‡∏•‡∏î‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏õ‡∏≤‡∏Å‡∏Å‡∏≤‡∏™‡∏µ‡πÅ‡∏î‡∏á‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠
      if (amountRedPen <= 5) // ‡∏´‡∏≤‡∏Å‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏õ‡∏≤‡∏Å‡∏Å‡∏≤‡∏™‡∏µ‡πÅ‡∏î‡∏á‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡πÑ‡∏°‡πà‡πÄ‡∏Å‡∏¥‡∏ô 5 ‡∏≠‡∏±‡∏ô
      {
        sendLineNotify("\nüî¥ ‡∏õ‡∏≤‡∏Å‡∏Å‡∏≤‡∏™‡∏µ‡πÅ‡∏î‡∏á‡πÉ‡∏Å‡∏•‡πâ‡∏à‡∏∞‡∏´‡∏°‡∏î‡πÅ‡∏•‡πâ‡∏ß\n\n‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏´‡∏•‡∏∑‡∏≠: " + String(amountRedPen) + " ‡∏î‡πâ‡∏≤‡∏°"); // ‡∏™‡πà‡∏á‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô
      }
      if (amountRedPen == 0) // ‡∏´‡∏≤‡∏Å‡∏õ‡∏≤‡∏Å‡∏Å‡∏≤‡∏™‡∏µ‡πÅ‡∏î‡∏á‡∏´‡∏°‡∏î
      {
        sendLineNotify("\nüî¥ ‡∏õ‡∏≤‡∏Å‡∏Å‡∏≤‡∏™‡∏µ‡πÅ‡∏î‡∏á‡∏´‡∏°‡∏î‡πÅ‡∏•‡πâ‡∏ß\n\n‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏ï‡∏¥‡∏°‡∏õ‡∏≤‡∏Å‡∏Å‡∏≤!!"); // ‡∏™‡πà‡∏á‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡πÉ‡∏´‡πâ‡πÄ‡∏ï‡∏¥‡∏°‡∏õ‡∏≤‡∏Å‡∏Å‡∏≤
      }
    }
    previousMillisPen = millis(); // ‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ï‡πÄ‡∏ß‡∏•‡∏≤‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏õ‡∏≤‡∏Å‡∏Å‡∏≤
    updateDisplay();              // ‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ï‡∏Å‡∏≤‡∏£‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡∏ö‡∏ô‡∏à‡∏≠ LCD
  }
  else
  {
    lcd.clear();                // ‡∏•‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ö‡∏ô‡∏à‡∏≠ LCD
    lcd.setCursor(2, 0);        // ‡∏ï‡∏±‡πâ‡∏á‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏Ç‡∏≠‡∏á‡πÄ‡∏Ñ‡∏≠‡∏£‡πå‡πÄ‡∏ã‡∏≠‡∏£‡πå‡∏ó‡∏µ‡πà‡πÅ‡∏ñ‡∏ß 0 ‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå 2
    lcd.print("Please insert"); // ‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏° "Please insert" ‡∏ö‡∏ô‡∏à‡∏≠ LCD
    lcd.setCursor(6, 1);        // ‡∏ï‡∏±‡πâ‡∏á‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏Ç‡∏≠‡∏á‡πÄ‡∏Ñ‡∏≠‡∏£‡πå‡πÄ‡∏ã‡∏≠‡∏£‡πå‡∏ó‡∏µ‡πà‡πÅ‡∏ñ‡∏ß 1 ‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå 6
    lcd.print("Coin");          // ‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏° "Coin" ‡∏ö‡∏ô‡∏à‡∏≠ LCD
    delay(2000);                // ‡∏£‡∏≠ 2000 ‡∏°‡∏¥‡∏•‡∏•‡∏¥‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ
    updateDisplay();            // ‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ï‡∏Å‡∏≤‡∏£‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡∏ö‡∏ô‡∏à‡∏≠ LCD
  }
}

void sendLineNotify(String message, String imageUrl)
{
  HTTPClient http;                                                     // ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏≠‡∏≠‡∏ö‡πÄ‡∏à‡πá‡∏Å‡∏ï‡πå HTTPClient
  http.begin("https://notify-api.line.me/api/notify");                 // ‡∏Å‡∏≥‡∏´‡∏ô‡∏î URL ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏™‡πà‡∏á‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô
  http.addHeader("Content-Type", "application/x-www-form-urlencoded"); // ‡πÄ‡∏û‡∏¥‡πà‡∏° Header ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
  http.addHeader("Authorization", "Bearer " + String(LINE_TOKEN));     // ‡πÄ‡∏û‡∏¥‡πà‡∏° Header ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå

  String httpRequestData = "message=" + message; // ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡∏™‡πà‡∏á‡∏Ñ‡∏≥‡∏Ç‡∏≠
  if (imageUrl != "")                            // ‡∏´‡∏≤‡∏Å‡∏°‡∏µ URL ‡∏Ç‡∏≠‡∏á‡∏†‡∏≤‡∏û
  {
    httpRequestData += "&imageThumbnail=" + imageUrl + "&imageFullsize=" + imageUrl; // ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• URL ‡∏Ç‡∏≠‡∏á‡∏†‡∏≤‡∏û
  }
  int httpResponseCode = http.POST(httpRequestData); // ‡∏™‡πà‡∏á‡∏Ñ‡∏≥‡∏Ç‡∏≠ POST ‡πÅ‡∏•‡∏∞‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏£‡∏´‡∏±‡∏™‡∏ï‡∏≠‡∏ö‡∏Å‡∏•‡∏±‡∏ö

  if (httpResponseCode > 0) // ‡∏´‡∏≤‡∏Å‡∏£‡∏´‡∏±‡∏™‡∏ï‡∏≠‡∏ö‡∏Å‡∏•‡∏±‡∏ö‡πÄ‡∏õ‡πá‡∏ô‡∏ö‡∏ß‡∏Å
  {
    Serial.print("HTTP Response code: "); // ‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏´‡∏±‡∏™‡∏ï‡∏≠‡∏ö‡∏Å‡∏•‡∏±‡∏ö‡πÉ‡∏ô Serial monitor
    Serial.println(httpResponseCode);     // ‡πÅ‡∏™‡∏î‡∏á‡∏£‡∏´‡∏±‡∏™‡∏ï‡∏≠‡∏ö‡∏Å‡∏•‡∏±‡∏ö
    String payload = http.getString();    // ‡∏£‡∏±‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡∏≠‡∏ö‡∏Å‡∏•‡∏±‡∏ö
    Serial.println(payload);              // ‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡∏≠‡∏ö‡∏Å‡∏•‡∏±‡∏ö‡πÉ‡∏ô Serial monitor
  }
  else
  {
    Serial.print("Error code: ");     // ‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏´‡∏±‡∏™‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô Serial monitor
    Serial.println(httpResponseCode); // ‡πÅ‡∏™‡∏î‡∏á‡∏£‡∏´‡∏±‡∏™‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î
  }
  http.end(); // ‡∏õ‡∏¥‡∏î‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠ HTTP
}

BLYNK_WRITE(V1)
{
  int val = param.asInt(); // ‡∏£‡∏±‡∏ö‡∏Ñ‡πà‡∏≤‡∏à‡∏≤‡∏Å Blynk
  servo1.write(val);       // ‡∏´‡∏°‡∏∏‡∏ô‡πÄ‡∏ã‡∏≠‡∏£‡πå‡πÇ‡∏ß 1 ‡πÑ‡∏õ‡∏¢‡∏±‡∏á‡∏°‡∏∏‡∏°‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö
}
BLYNK_WRITE(V2)
{
  int val = param.asInt(); // ‡∏£‡∏±‡∏ö‡∏Ñ‡πà‡∏≤‡∏à‡∏≤‡∏Å Blynk
  servo2.write(val);       // ‡∏´‡∏°‡∏∏‡∏ô‡πÄ‡∏ã‡∏≠‡∏£‡πå‡πÇ‡∏ß 2 ‡πÑ‡∏õ‡∏¢‡∏±‡∏á‡∏°‡∏∏‡∏°‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö
}
BLYNK_WRITE(V3)
{
  if (param.asInt() == 1) // ‡∏´‡∏≤‡∏Å‡∏Ñ‡πà‡∏≤‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡πÄ‡∏õ‡πá‡∏ô 1
  {
    releaseBluePen(); // ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡πÉ‡∏ä‡πâ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô releaseBluePen()
  }
}
BLYNK_WRITE(V4)
{
  if (param.asInt() == 1) // ‡∏´‡∏≤‡∏Å‡∏Ñ‡πà‡∏≤‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡πÄ‡∏õ‡πá‡∏ô 1
  {
    releaseRedPen(); // ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡πÉ‡∏ä‡πâ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô releaseRedPen()
  }
}
BLYNK_WRITE(V5)
{
  if (!relayCoinValidatorState) // ‡∏´‡∏≤‡∏Å relayCoinValidatorState ‡πÄ‡∏õ‡πá‡∏ô false
  {
    if (param.asInt() == 1) // ‡∏´‡∏≤‡∏Å‡∏Ñ‡πà‡∏≤‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡πÄ‡∏õ‡πá‡∏ô 1
    {
      digitalWrite(relayPin12V, LOW); // ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏Ç‡∏≤ relayPin12V ‡πÄ‡∏õ‡πá‡∏ô LOW
      relayCoinValidatorState = true; // ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ relayCoinValidatorState ‡πÄ‡∏õ‡πá‡∏ô true
      lcd.clear();                    // ‡∏•‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ö‡∏ô‡∏à‡∏≠ LCD
      lcd.setCursor(5, 0);            // ‡∏ï‡∏±‡πâ‡∏á‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏Ç‡∏≠‡∏á‡πÄ‡∏Ñ‡∏≠‡∏£‡πå‡πÄ‡∏ã‡∏≠‡∏£‡πå‡∏ó‡∏µ‡πà‡πÅ‡∏ñ‡∏ß 0 ‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå 5
      lcd.print("System");            // ‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏° "System" ‡∏ö‡∏ô‡∏à‡∏≠ LCD
      lcd.setCursor(2, 1);            // ‡∏ï‡∏±‡πâ‡∏á‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏Ç‡∏≠‡∏á‡πÄ‡∏Ñ‡∏≠‡∏£‡πå‡πÄ‡∏ã‡∏≠‡∏£‡πå‡∏ó‡∏µ‡πà‡πÅ‡∏ñ‡∏ß 1 ‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå 2
      lcd.print("Shutting Down.");    // ‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏° "Shutting Down." ‡∏ö‡∏ô‡∏à‡∏≠ LCD
      delay(2000);                    // ‡∏£‡∏≠ 2000 ‡∏°‡∏¥‡∏•‡∏•‡∏¥‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ
      totalAmount = 0;                // ‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏¢‡∏≠‡∏î‡πÄ‡∏á‡∏¥‡∏ô‡∏£‡∏ß‡∏°
      pens = 0;                       // ‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏õ‡∏≤‡∏Å‡∏Å‡∏≤
      disconnectCoinValidator();      // ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡πÉ‡∏ä‡πâ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô disconnectCoinValidator()
      delay(2000);                    // ‡∏£‡∏≠ 2000 ‡∏°‡∏¥‡∏•‡∏•‡∏¥‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ
      connectCoinValidator();         // ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡πÉ‡∏ä‡πâ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô connectCoinValidator()
    }
  }
  else // ‡∏´‡∏≤‡∏Å relayCoinValidatorState ‡πÄ‡∏õ‡πá‡∏ô true
  {
    if (param.asInt() == 0) // ‡∏´‡∏≤‡∏Å‡∏Ñ‡πà‡∏≤‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡πÄ‡∏õ‡πá‡∏ô 0
    {
      digitalWrite(relayPin12V, HIGH); // ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏Ç‡∏≤ relayPin12V ‡πÄ‡∏õ‡πá‡∏ô HIGH
      relayCoinValidatorState = false; // ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ relayCoinValidatorState ‡πÄ‡∏õ‡πá‡∏ô false
      lcd.clear();                     // ‡∏•‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ö‡∏ô‡∏à‡∏≠ LCD
      lcd.setCursor(5, 0);             // ‡∏ï‡∏±‡πâ‡∏á‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏Ç‡∏≠‡∏á‡πÄ‡∏Ñ‡∏≠‡∏£‡πå‡πÄ‡∏ã‡∏≠‡∏£‡πå‡∏ó‡∏µ‡πà‡πÅ‡∏ñ‡∏ß 0 ‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå 5
      lcd.print("System");             // ‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏° "System" ‡∏ö‡∏ô‡∏à‡∏≠ LCD
      lcd.setCursor(2, 1);             // ‡∏ï‡∏±‡πâ‡∏á‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏Ç‡∏≠‡∏á‡πÄ‡∏Ñ‡∏≠‡∏£‡πå‡πÄ‡∏ã‡∏≠‡∏£‡πå‡∏ó‡∏µ‡πà‡πÅ‡∏ñ‡∏ß 1 ‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå 2
      lcd.print("Starting....");       // ‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏° "Starting...." ‡∏ö‡∏ô‡∏à‡∏≠ LCD
      delay(2000);                     // ‡∏£‡∏≠ 2000 ‡∏°‡∏¥‡∏•‡∏•‡∏¥‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ
      updateDisplay();                 // ‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ï‡∏Å‡∏≤‡∏£‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡∏ö‡∏ô‡∏à‡∏≠ LCD
      amountBluePen = 10;              // ‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏õ‡∏≤‡∏Å‡∏Å‡∏≤‡∏™‡∏µ‡∏ô‡πâ‡∏≥‡πÄ‡∏á‡∏¥‡∏ô
      amountRedPen = 10;               // ‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏õ‡∏≤‡∏Å‡∏Å‡∏≤‡∏™‡∏µ‡πÅ‡∏î‡∏á
    }
  }
}

void disconnectCoinValidator()
{
  detachInterrupt(digitalPinToInterrupt(coinValidatorPin)); // ‡∏´‡∏¢‡∏∏‡∏î‡∏Å‡∏≤‡∏£‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏° interrupt ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö coinValidatorPin
}

void connectCoinValidator()
{
  attachInterrupt(digitalPinToInterrupt(coinValidatorPin), doCounter, FALLING); // ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ interrupt ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö coinValidatorPin
}

void releaseBluePen()
{
  moveServo("blue", LEFT, 200);  // ‡πÄ‡∏Ñ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏ã‡∏≠‡∏£‡πå‡πÇ‡∏ß‡∏™‡∏µ‡∏ü‡πâ‡∏≤‡πÑ‡∏õ‡∏ó‡∏≤‡∏á‡∏ã‡πâ‡∏≤‡∏¢
  moveServo("blue", RIGHT, 210); // ‡πÄ‡∏Ñ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏ã‡∏≠‡∏£‡πå‡πÇ‡∏ß‡∏™‡∏µ‡∏ü‡πâ‡∏≤‡πÑ‡∏õ‡∏ó‡∏≤‡∏á‡∏Ç‡∏ß‡∏≤
}

void releaseRedPen()
{
  moveServo("red", LEFT, 200);  // ‡πÄ‡∏Ñ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏ã‡∏≠‡∏£‡πå‡πÇ‡∏ß‡∏™‡∏µ‡πÅ‡∏î‡∏á‡πÑ‡∏õ‡∏ó‡∏≤‡∏á‡∏ã‡πâ‡∏≤‡∏¢
  moveServo("red", RIGHT, 210); // ‡πÄ‡∏Ñ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏ã‡∏≠‡∏£‡πå‡πÇ‡∏ß‡∏™‡∏µ‡πÅ‡∏î‡∏á‡πÑ‡∏õ‡∏ó‡∏≤‡∏á‡∏Ç‡∏ß‡∏≤
}